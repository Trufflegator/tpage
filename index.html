
<!DOCTYPE html>
<html>
<head>
	<title>MorphCast API Example</title>
</head>
<body>
	<script src="https://sdk.morphcast.com/mphtools/v1.1/mphtools.js" data-config="cameraPrivacyPopup, compatibilityUI, compatibilityAutoCheck"></script>
	<script src="https://ai-sdk.morphcast.com/v1.16/ai-sdk.js"></script>
	<script src="https://sdk.morphcast.com/emotion-statistics/v1.0-beta/script.js"></script>
	<script>
		const statsConfig = {
			sendDatainterval: 5000,
			tickInterval: 1000,
			stopAfter: 20000,
			licenseKey: "0066c29e9934d3f31f5f674826f9443ee0b78f7b6ed6"
		};
		const statisticsUploader = new MorphCastStatistics.StatisticsUploader(statsConfig);

		CY.loader()
			.licenseKey("0066c29e9934d3f31f5f674826f9443ee0b78f7b6ed6")
			.addModule(CY.modules().FACE_AROUSAL_VALENCE.name, {smoothness: 0.70})
			.addModule(CY.modules().FACE_EMOTION.name, {smoothness: 0.40})
			.addModule(CY.modules().FACE_ATTENTION.name, {smoothness: 0.83})
			.addModule(CY.modules().FACE_WISH.name, {smoothness: 0.8})
			.addModule(CY.modules().DATA_AGGREGATOR.name, {initialWaitMs: 2000, periodMs: 1000})
			.addModule(CY.modules().FACE_POSITIVITY.name, {smoothness: 0.40, gain: 2, angle: 17})
			.load()
			.then(async ({ start, stop }) => {
				await start();
				await statisticsUploader.start();

				setTimeout(async () => {
					await statisticsUploader.stop();
					await stop();
				}, statsConfig.stopAfter);
			});

		window.addEventListener(CY.modules().EVENT_BARRIER.eventName, (evt) => {
			console.log('EVENT_BARRIER result', evt.detail);
		});

		window.addEventListener(CY.modules().DATA_AGGREGATOR.eventName, (evt) => {
			console.log('DATA_AGGREGATOR result', evt.detail);
		});

		MphTools.CameraPrivacyPopup.setText({
			"title": "Allow us to use your camera",
			"description": "This experience is designed to be viewed with your camera on. The next screen will ask your consent to access data from your camera.",
			"url": "https://YOUR_DOMAIN/<YOUR_PRIVACY_POLICY>"
		});
	</script>

	<!-- your body part -->
    <div style="width: 100%; height: 100%; background-color: #000000; color: #ffffff; text-align: center; font-size: 30px; padding-top: 100px;">
        <div style="margin-bottom: 20px;">This is a testing page for MorphCast API.</div>
        <div style="margin-bottom: 20px;">Please allow your camera to start.</div>
        <div style="margin-bottom: 20px;">You can check the console log for the result.</div>
        <div style="margin-bottom: 20px;">If you want to test the emotion statistics, please click the button below.</div>
        <button onclick="statisticsUploader.upload()">Upload statistics</button>
    </div>
</body>
</html>
